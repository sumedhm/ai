%1-boundaryview
%2-non-boundaryview
BV = [[1653,1760,1];[3256,3316,1];[3385,3447,1];[6853,6884,1];
    [8957,9008,1];[9305,9328,1];[9401,9448,1];[9720,9772,1];
    [9941,9964,1];[10413,10428,1];[16138,16172,1];
    [16461,16470,1];[19375,19409,1];[22965,23000,1];
    [24525,24548,1];[29514,29530,1];[29502,29513,1];
    [625,713,2];[1141,1166,2];[1205,1222,2];[1288,1393,2];
    [2117,2136,2];[2149,2172,2];[2199,2223,2];[2645,2732,2];
    [2741,2812,2];[3340,3363,2];[4094,4152,2];[4457,4544,2];
    [4667,4717,2];[5262,5328,2];[5333,5453,2];[5927,6048,2];
    [6178,6213,2];[6788,6828,2];[6925,7038,2];[7377,7469,2];
    [10370,10381,2];[10542,10582,2];[10961,11020,2];
    [13953,13980,2];[20008,20028,2];[28978,29002,2];
    [29456,29480,2];[20035,20067,2];[20108,20138,2];
    [20548,20606,2];[21308,21365,2];[21890,21943,2];
    [22507,22571,2];
    [590,624,2];[1173,1199,2];[1229,1287,2];[1555,1647,2];
    [3325,3332,2];[4341,4436,2];[6229,6259,2];[7517,7548,2];
    [9034,9065,2];[9990,10024,2];[11749,11776,2];[13781,13850,2];
    [15029,15108,2];[15341,15572,2];[19489,19500,2];[26018,26029,2];
    [26619,26633,2];[26950,26996,2];[28363,28387,2];
    [30135,30142,2];[30363,30380,2];[31374,31395,2];
    [30406,30437,2]];
fName = 'boundaryview_svm.csv';
fid = fopen(fName, 'w');    

TD = [[8947,8965,1];[9400,9448,1];[9720,9777,1];
    [12313,12378,1];[19410,19452,1];[20721,20736,1];
    [23001,23088,1];[24525,24547,1];[24965,24980,1];
    [26581,26604,1];[26643,26658,1];[26649,26658,1];
    [537,578,2];[897,996,2];[2115,2223,2];[2733,2812,2];
    [3340,3355,2];[3448,3555,2];[4737,4772,2];[7360,7377,2];
    [7470,7503,2];[8074,8098,2];[8105,8151,2];[8339,8377,2];
    [8909,8943,2];[9881,9914,2];[10382,10390,2];[11700,11728,2];
    [12260,12282,2];[12379,12413,2];[12791,12807,2];[12825,12853,2];
    [13341,13360,2]
    [15165,15197,2];[16081,16119,2];[16174,16216,2];
    [23197,23213,2];[23509,23557,2];[24637,24711,2];
    [24993,25020,2];[26025,26055,2];[23193,23213,2];
    [26949,26968,2];[23490,23557,2];[28388,28396,2];
    [28925,28976,2];[30339,30353,2];[31396,31406,2];
    [28363,28396,2];[31736,31779,2]]; %test data
x = 0;

for i = 1:size(BV)
   for j = BV(i, 1):BV(i, 2)
        x = x + 1;
   end
end

no_of_training_data = x;
training_data = zeros(no_of_training_data, 256);
labels = zeros(1, no_of_training_data);
x = 1;
for i = 1:size(BV)
   for j = BV(i, 1):BV(i, 2)
       class = BV(i, 3);
       img = sprintf('../images/img%d.jpg', j);
       disp(sprintf('training - %d - class - %d', j, class));
       fprintf(fid, ',%s,%d,manual\r\n', img, class);
       I = rgb2hsv(im2double(imread(img)));
       I = imhist(I(:,:,1));
       training_data(x,:) = I;
       labels(x) = class;
       x = x + 1;
   end
end

disp('Training svm');
SVMtrainedbv = svmtrain(training_data, labels);

x = 1;
for i = 1:size(TD)
    for j = TD(i,1):TD(i,2)
        class = TD(i, 3);
        img = sprintf('../images/img%d.jpg', j);
        I = rgb2hsv(imread(img));
        test = transp(imhist(I(:,:,1)));
        label = svmclassify(SVMtrainedbv, test);
        disp(sprintf('testing - %d, class - %d', j, label));
        fprintf(fid, ',%s,%d,%d\r\n', img, label, class);       
    end
end

fclose(fid);